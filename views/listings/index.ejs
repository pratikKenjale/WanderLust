<% layout('layouts/boilerplate') %>



<div class="filters d-flex justify-content-between align-items-center flex-wrap gap-1 border-bottom pb-3 mt-3">

  <div class="tax-toggle">
    <div class="form-check-reverse form-switch">
       <input class="form-check-input" type="checkbox" role="switch" id="switchCheckDefault">
        <label class="form-check-label" for="switchCheckDefault">Display Taxes</label>
    </div>
  </div>

</div>


<!-- ✅ No Results Message (only on search) -->
<% if (req.query.q && listings.length === 0) { %>
  <div class="text-center mt-4">
    <h5>No results found for "<%=req.query.q %>"</h5>
  </div>
<% } %>

<!-- ✅ Listings Display -->
<div class="row row-cols-lg-3 row-cols-md-2 row-cols-sm-1 mt-3">

<% for (let listing of listings) { %> 
  <div class="col" style="margin-bottom: 1rem;">
    <a href="/listings/<%= listing.id %>" style="text-decoration: none; color: inherit;">
      <div class="card listing-card" style="width: 20rem;">
        <img src="<%= listing.image.url %>" class="card-img-top" alt="listing_image" style="height:20rem;">
        <div class="card-img-overlay"></div>
        <div class="card-body">
          <div class="card-body px-2">
             <p class="mb-1 fw-semibold" style="font-size: 1rem;"><%= listing.title %></p>
             <div class="d-flex align-items-center gap-2">
             <span class="text-muted">&#8377;<%= listing.price %> <span style="font-size: 0.9rem;">/night</span></span>
              <span class="tax-info text-muted fst-italic" style="font-size: 0.85rem;">+18% GST</span>
             </div>
          </div>


        </div>
      </div>
    </a>
  </div>
<% } %>

</div>


<script>
  const taxSwitch = document.getElementById("switchCheckDefault");

  // ✅ Toggle visibility based on checked state
  taxSwitch.addEventListener("change", () => {
    const taxInfos = document.querySelectorAll(".tax-info");
    const showTaxes = taxSwitch.checked; // true = ON

    taxInfos.forEach(info => {
      info.style.display = showTaxes ? "inline" : "none";
    });
  });

  // ✅ Optional: Hide taxes by default on page load
  window.addEventListener("DOMContentLoaded", () => {
    const taxInfos = document.querySelectorAll(".tax-info");
    taxInfos.forEach(info => {
      info.style.display = "none";
    });
  });
</script>

